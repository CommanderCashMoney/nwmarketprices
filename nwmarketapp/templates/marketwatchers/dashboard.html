{% extends 'base.html' %}
{% block nav %}
    {% with is_login_nav=True %}
        {{ block.super }}
    {% endwith %}
{% endblock %}
{% load static %}
{% load humanize %}
{% block additional_includes %}
     <script src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"></script>
     <script src="https://cdn.datatables.net/1.13.1/js/dataTables.bulma.min.js"></script>
    <script src="{% static 'nwmarketapp/dashboard.js' %}"></script>
    <script src="{% static 'nwmarketapp/dashboard-typeahead.js' %}"></script>
{% endblock %}


{% block content %}

{#<div class="tile is-ancestor" style="margin-top: 0px">#}
{#  <div class="tile is-parent">#}
{#    <article class="tile is-child box" id="item-tracking">#}
{#      <p class="title">Welcome to your monitoring dashboard</p>#}
{#        <p class="subtitle">Here you can choose up to 10 items to monitor changes on. Other useful graphs and data can be found below. Some data is only available to Market Watchers. To sign up visit the #become-a-scanner channel on <a>Discord</a>.</p>#}
{#        <div class="content">#}
{#            To get started <a id="item-selection-modal-trigger" style="text-decoration: underline">click here to choose your items to track</a>#}
{##}
{#        </div>#}
{##}
{#    </article>#}
{#  </div>#}
{##}
{#</div>#}
<div class="tile is-ancestor" style="margin-top: 0px">
  <div class="tile is-parent">

    <article class="tile is-child box white-border" id="item-tracking">

         <p class="subtitle">Custom item tracking. <a>Click here</a> to change.</p>
      <div class="columns">

              {% for item in dashboard_data %}
                   {% if forloop.first %}<div class="column">{% endif %}
              <article class="tile box tracked-item ">
               <div class="grid-container">
                  <div class="item-name is-size-6">{{ item.item_name }}</div>
                  <div class="updated timestamp">Updated: {{ item.last_checked|naturaltime }}</div>
                  <div class="mini-graph"><div id="chart-{{ item.item_id }}" class="chart" style="width: 164px;height: 45px;"></div></div>
                  <div class="price is-size-6">{{ item.lowest_price.price }}</div>
                   {% if item.price_change < 0 %}
                        <div class="change is-size-6 yellow_text">{{ item.price_change }}%</div>
                   {% else %}
                         <div class="change is-size-6 blue_text">{{ item.price_change }}%</div>
                   {% endif %}


               </div>

              </article>


                {% if forloop.counter|divisibleby:3 and not forloop.last %}</div><div class="column"> {% endif %}

              {% endfor %}

          </div>



</div>

    </article>
  </div>

</div>
<div class="tile is-ancestor">
  <div class="tile is-vertical is-8">
    <div class="tile">
      <div class="tile is-parent is-vertical">
        <article class="tile is-child box">
          <p class="title">Higher vs other servers</p>
          <p class="subtitle">Top box</p>
        </article>
        <article class="tile is-child box">
          <p class="title">Lower vs other servers</p>
          <p class="subtitle">Bottom box</p>
        </article>
      </div>
      <div class="tile is-parent">
        <article class="tile is-child box">
          <p class="title">Price increases</p>
          <p class="subtitle">With an image</p>
          <figure class="image is-4by3">
            <img src="https://bulma.io/images/placeholders/640x480.png">
          </figure>
        </article>
      </div>
    </div>

  </div>
  <div class="tile is-parent">
    <article class="tile is-child box">
      <div class="content">
        <p class="title">Price drops</p>
        <p class="subtitle">With even more content</p>
        <div class="content">
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam semper diam at erat pulvinar, at pulvinar felis blandit. Vestibulum volutpat tellus diam, consequat gravida libero rhoncus ut. Morbi maximus, leo sit amet vehicula eleifend, nunc dui porta orci, quis semper odio felis ut quam.</p>
          <p>Suspendisse varius ligula in molestie lacinia. Maecenas varius eget ligula a sagittis. Pellentesque interdum, nisl nec interdum maximus, augue diam porttitor lorem, et sollicitudin felis neque sit amet erat. Maecenas imperdiet felis nisi, fringilla luctus felis hendrerit sit amet. Aenean vitae gravida diam, finibus dignissim turpis. Sed eget varius ligula, at volutpat tortor.</p>
          <p>Integer sollicitudin, tortor a mattis commodo, velit urna rhoncus erat, vitae congue lectus dolor consequat libero. Donec leo ligula, maximus et pellentesque sed, gravida a metus. Cras ullamcorper a nunc ac porta. Aliquam ut aliquet lacus, quis faucibus libero. Quisque non semper leo.</p>
        </div>
      </div>
    </article>
  </div>
</div>

<div class="tile is-ancestor">
  <div class="tile is-parent">
    <article class="tile is-child box">
      <p class="title">Side column</p>
      <p class="subtitle">With some content</p>
      <div class="content">
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin ornare magna eros, eu pellentesque tortor vestibulum ut. Maecenas non massa sem. Etiam finibus odio quis feugiat facilisis.</p>
      </div>
    </article>
  </div>
  <div class="tile is-parent is-8">
    <article class="tile is-child box">
      <p class="title">Main column</p>
      <p class="subtitle">With some content</p>
      <div class="content">
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin ornare magna eros, eu pellentesque tortor vestibulum ut. Maecenas non massa sem. Etiam finibus odio quis feugiat facilisis.</p>
      </div>
    </article>
  </div>
</div>
<script>
window.onload = function(){
    let mini_graph_data = null
    {% for item in dashboard_data %}
        mini_graph_data = {{item.graph_data|safe}}
            console.log(mini_graph_data)
        create_mini_graph(mini_graph_data, 'chart-{{ item.item_id }}')
    {% endfor %}



}

</script>

{% include 'marketwatchers/snippets/pop-modal.html' %}
{% endblock %}
